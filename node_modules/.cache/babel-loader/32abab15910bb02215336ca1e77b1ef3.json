{"ast":null,"code":"'use strict';\n\nconst net = require('net');\n\nconst EventEmitter = require('events').EventEmitter;\n\nconst Connection = require('./connection');\n\nconst ConnectionConfig = require('./connection_config'); // TODO: inherit Server from net.Server\n\n\nclass Server extends EventEmitter {\n  constructor() {\n    super();\n    this.connections = [];\n    this._server = net.createServer(this._handleConnection.bind(this));\n  }\n\n  _handleConnection(socket) {\n    const connectionConfig = new ConnectionConfig({\n      stream: socket,\n      isServer: true\n    });\n    const connection = new Connection({\n      config: connectionConfig\n    });\n    this.emit('connection', connection);\n  }\n\n  listen(port) {\n    this._port = port;\n\n    this._server.listen.apply(this._server, arguments);\n\n    return this;\n  }\n\n  close(cb) {\n    this._server.close(cb);\n  }\n\n}\n\nmodule.exports = Server;","map":null,"metadata":{},"sourceType":"script"}